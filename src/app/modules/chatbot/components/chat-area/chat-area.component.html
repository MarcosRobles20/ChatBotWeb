<div class="chat-area mat-app-background">
    <div class="messages" #messageContainer [appAutoScroll]="true" [messages]="messages">
      <!-- Welcome message when messages are empty -->
      <div class="welcome-message" *ngIf="messages.length === 0">
        <div class="welcome-icon">
          <img src="/images/salchi_pixel_ready.png" alt="Salchi" class="welcome-logo">
        </div>
        <h2 class="welcome-title">Â¡Bienvenido a tu asistente Wiener!</h2>
        <p class="welcome-text">PequeÃ±o, ligero y poderoso</p>
      </div>

      <!-- Chat messages -->
      <ng-container *ngFor="let message of messages; trackBy: trackByTimestamp">
        <mat-card class="message" [class.user-message]="message.isUser">
          <mat-card-content class="message-content">
            <div class="thinking-inline" *ngIf="!message.isUser && message.showThinking">
              <button type="button" class="thinking-inline-toggle" (click)="onToggleThinking(message.timestamp)">
                <span>ğŸ§  Pensando...</span>
                <span>{{ message.thinkingCollapsed ? 'â–¶' : 'â–¼' }}</span>
              </button>

              <div class="thinking-inline-content" *ngIf="!message.thinkingCollapsed">
                {{ message.thinkingContent || 'Pensando...' }}
              </div>
            </div>

            <div class="message-text response-block" [class.streaming-cursor]="!!message.streaming" [innerHTML]="message.content | markdown"></div>
          </mat-card-content>
          <div class="message-time">
            {{ message.timestamp | date:'dd/MM/yyyy HH:mm:ss' }}
          </div>
        </mat-card>
      </ng-container>
    </div>
  </div>